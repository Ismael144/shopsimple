syntax = "proto3";

package shopsimple.product.v1;

import "google/api/annotations.proto";
import "google/protobuf/timestamp.proto";

option go_package = "gen/go/shopsimple/product/v1;productv1";

// Products service
service ProductService {
  // List paginated products
  rpc List(ListRequest) returns (ListResponse) {
    option (google.api.http) = {
      get: "/products/v1/list"
    };
  };

  // Create New product
  rpc Create(CreateRequest) returns (CreateResponse) {
    option (google.api.http) = {
      post: "/products/v1/create"
      body: "*"
    };
  };

  // Filter by properties
  rpc Filter(FilterRequest) returns (ListResponse) {
    option (google.api.http) = {
      get: "/products/v1/filter"
    };
  };

  // Batch Find by id
  rpc BatchFindById(BatchFindByIdRequest) returns (ListResponse) {
    option (google.api.http) = {
      post: "/products/v1/batch-find-by-id"
      body: "*"
    };
  };

  // Batch Find by id
  rpc FindById(FindByIdRequest) returns (Product) {
    option (google.api.http) = {
      get: "/products/v1/"
    };
  };

  // Create Product Category
  rpc CreateCategory(CreateCategoryRequest) returns (CreateCategoryResponse) {
    option (google.api.http) = {
      post: "/products/v1/create_category"
      body: "*"

    };
  };

  // List Categories
  rpc ListCategories(ListCategoriesRequest) returns (ListCategoriesResponse) {
    option (google.api.http) = {
      get: "/products/v1/list_categories"
    };
  };
}

message Product {
  string                    id          = 1;
  string                    name        = 2;
  string                    description = 3;
  double                    unit_price  = 4;
  string                    image_url   = 5;
  uint64                    stock       = 6;
  string                    category_id = 7;
  google.protobuf.Timestamp created_at  = 8;
}

message ProductCategory {
  string                    id         = 1;
  string                    name       = 2;
  google.protobuf.Timestamp created_at = 3;
}

message ListRequest {
  uint32 page      = 1;
  uint32 page_size = 2;
}

message ListResponse {
  repeated Product products = 1;
  uint32           total    = 2;
}

message CreateRequest {
  string                    name        = 1;
  string                    description = 2;
  float                     unit_price  = 3;
  string                    image_url   = 4;
  uint32                    stock       = 5;
  string                    category_id = 6;
  google.protobuf.Timestamp created_at  = 7;
}

message CreateResponse {
  string product_id = 1;
}

message FilterRequest {
  uint32          page          = 1;
  uint32          page_size     = 2;
  string          search_string = 3;
  repeated string categories    = 4;
  PriceRanges     price_ranges  = 5;
}

message PriceRanges {
  float min = 1;
  float max = 2;
}

message BatchFindByIdRequest {
  repeated string ids = 1;
}

message FindByIdRequest {
  string id = 1;
}

message ListCategoriesRequest {}

message ListCategoriesResponse {
  repeated ProductCategory categories = 1;
  uint32                   total      = 2;
}

message CreateCategoryRequest {
  string name = 1;
}

message CreateCategoryResponse {}


